;<MON>STRING.MAC;2	2/28/77			EDIT BY RINDFLEISCH
; Added USRMOD switch to allow use in user mode GTJFN

	SEARCH	FILEDEF
	TITLE	STRING
IFE USRMOD,<	USE	SWAPPC  >

EXTERN	CPOPJ,SKPRET

STRDEV::REPEAT BIND,<
	CPOPJ>
	STRIN
	STROUT
	REPEAT SDSTD-BOUTD,<
	CPOPJ>

STRIN:	IFN KAFLG,<TLZ JFN,20>
	IFN KIFLG,<TLZ JFN,37>
	XCTBU [ILDB A,JFN]
	POPJ P,

STROUT:	IFN KAFLG,<TLZ JFN,20>
	IFN KIFLG,<TLZ JFN,37>
	XCTBU [IDPB A,JFN]
	POPJ P,

DBP::	LDB B,[POINT 6,A,5]
	LDB C,[POINT 6,A,11]
	ADD B,C
	IDIVI B,^D36
	JUMPE B,DBP1
	SUB A,B
	LDB C,[POINT 6,A,11]
	MOVEI B,^D36
	PUSH P,C
	IDIV B,C
	POP P,C
	IMUL B,C
	MOVNI C,-^D36(B)
DBP1:	DPB C,[POINT 6,A,5]
	POPJ P,

	END
